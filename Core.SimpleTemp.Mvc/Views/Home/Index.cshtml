@using System.Runtime.InteropServices;
@using System.Diagnostics;




<section class="content">
    <div class="callout callout-info">
        <h4>Tip!</h4>

        <p>
            <br>@($"系统架构：{RuntimeInformation.OSArchitecture}");
            <br>@($"系统名称：{RuntimeInformation.OSDescription}");
            <br>@($"进程架构：{RuntimeInformation.ProcessArchitecture}");
            <br>@($"是否64位操作系统：{Environment.Is64BitOperatingSystem}");
            <br>@($"机器名称：{Environment.MachineName}");

            @{
                Process[] p = Process.GetProcesses();//获取进程信息
                Int64 totalMem = 0;
                string info = "[";
                foreach (Process pr in p)
                {
                    totalMem += pr.WorkingSet64 / 1024;
                    //info += pr.ProcessName + "内存：-----------" + (pr.WorkingSet64 / 1024).ToString() + "KB\r\n";//得到进程内存
                    info += $"{{ label:\"{pr.ProcessName}\" , value:{((pr.WorkingSet64 / 1024 / 1024)).ToString()} }},";

                }
                info = info.TrimEnd(',');
                info += "]";
            }
            <br>@("所有进程使用内存:" + totalMem / 1024 + "M");

        </p>
    </div>

    <div class="row">
        <div class="col-xs-5">
            <div class="box box-danger">
                <div class="box-header with-border">
                    <h3 class="box-title">当前系统进程占用内存资源使用情况</h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <canvas id="pieChart" style="height: 349px; width: 698px;" height="383" width="767"></canvas>
                </div>
                <!-- /.box-body -->
            </div>
        </div>

    </div>
    <!-- Default box -->

    <div class="box">
        <div class="box-header with-border">
            <h3 class="box-title">Title</h3>

            <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="" data-original-title="Collapse">
                    <i class="fa fa-minus"></i>
                </button>
                <button type="button" class="btn btn-box-tool" data-widget="remove" data-toggle="tooltip" title="Remove">
                    <i class="fa fa-times"></i>
                </button>
            </div>
        </div>
        <div class="box-body">

        </div>
        <!-- /.box-body -->
        <div class="box-footer">
            Footer
        </div>
        <!-- /.box-footer-->
    </div>
    <!-- /.box -->
</section>

<script src="http://adminlte.la998.com/plugins/chartjs/Chart.min.js"></script>">

<script>

    $(function () {

        //-------------
        //- PIE CHART -
        //-------------
        // Get context with jQuery - using jQuery's .get() method.
        var pieChartCanvas = $("#pieChart").get(0).getContext("2d");
        var pieChart = new Chart(pieChartCanvas);
        var PieData = @Html.Raw(info)
            ;
        var pieOptions = {
            //Boolean - Whether we should show a stroke on each segment
            segmentShowStroke: true,
            //String - The colour of each segment stroke
            segmentStrokeColor: "#fff",
            //Number - The width of each segment stroke
            segmentStrokeWidth: 2,
            //Number - The percentage of the chart that we cut out of the middle
            percentageInnerCutout: 20, // This is 0 for Pie charts
            //Number - Amount of animation steps
            animationSteps: 100,
            //String - Animation easing effect
            animationEasing: "easeOutBounce",
            //Boolean - Whether we animate the rotation of the Doughnut
            animateRotate: true,
            //Boolean - Whether we animate scaling the Doughnut from the centre
            animateScale: false,
            //Boolean - whether to make the chart responsive to window resizing
            responsive: true,
            // Boolean - whether to maintain the starting aspect ratio or not when responsive, if set to false, will take up entire container
            maintainAspectRatio: true,
            //String - A legend template
            legendTemplate: "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span style=\"background-color:<%=segments[i].fillColor%>\"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>"
        };
        //Create pie or douhnut chart
        // You can switch between pie and douhnut using the method below.
        pieChart.Doughnut(PieData, pieOptions);
    })
</script>